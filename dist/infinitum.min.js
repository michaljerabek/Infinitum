!function(t){var e="",i=function(){var t=document.createElement("div"),i="transform";return["","o","ms","moz","webkit"].some(function(s){var n=s?s+"Transform":"transform";if(void 0!==t.style[n])return i=n,e=s?"-"+s+"-":"",!0}),i}(),s=function(){var t=document.createElement("div");return t.style[i]="translate3d(0,0,0)",!!t.style[i]}(),n="transition",r="",o=function(){var t=document.createElement("div"),e=["transition","transitionend","","OTransition","otransitionend","-o-","MozTransition","transitionend","-moz-","WebkitTransition","webkitTransitionEnd","-webkit-"],i=0,s=e.length;for(i;i<s;i+=3)if(void 0!==t.style[e[i]])return n=e[i],r=e[i+2],e[i+1];return null}(),a=function(t){var e=t.css(i);return{value:(e="none"!==e&&e?e:"matrix(1, 0, 0, 1, 0, 0)").replace(/^.*\((.*)\)$/g,"$1").split(/, +/),is3d:-1!==e.indexOf("3d")}},h=function(t){var e=a(t);return{x:e.is3d?+e.value[12]:+e.value[4],y:e.is3d?+e.value[13]:+e.value[5]}},l=function(t,e,i){i=i||0;var s="client"+e.toUpperCase();return t=t.originalEvent||t,"number"==typeof t[s]?t[s]:t.touches[i]?t.touches[i][s]:0},d=function(t){return(t instanceof HTMLElement?t:t[0]).getBoundingClientRect()},c=function(){var e=t([null]);return function(t){return e[0]=t,e}}(),f=t(window),u="Infinitum",m={self:"infinitum",disabled:"infinitum--disabled",start:"infinitum--start",end:"infinitum--end",center:"infinitum--center",debug:"infinitum--debug",item:"infinitum__item",current:"infinitum__item--current",possibleCurrent:"infinitum__item--possible-current",hide:"infinitum__item--hide",toEnd:"infinitum__item--to-end",toStart:"infinitum__item--to-start",track:"infinitum__track",dragging:"infinitum__track--dragging",moving:"infinitum__track--moving",speed0:"infinitum__track--static",speed1:"infinitum__track--slow",speed2:"infinitum__track--medium",speed3:"infinitum__track--fast",selector:function(t,e){return(e?":not(":"")+"."+this[t]+(e?")":"")}},p={willLeft:"willLeft",willTranslate:"willTranslate",translate:"translate",offset:"offset",fakeTransitionTimeout:"fakeTransitionTimeout",url:"infinitum-url"},_={START:"start",END:"end",CENTER:"center"},v={CLOSEST:"closest",STILL_INSIDE:"still-inside",FULL:"full"},T={selector:m.selector("self"),el:null,trackSelector:null,itemSelector:null,reverseItems:!1,mode:_.START,wheelKeysTapSetCurrent:!0,fade:!0,currentIn:v.CLOSEST,currentOut:v.STILL_INSIDE,clearEdge:!0,breakAll:!1,startBreak:_.CENTER,endBreak:_.END,breakOnEdge:!1,balanced:!1,refreshItems:!0,debug:!1},g=[],E=[],I=1,C=window.Infinitum=function(t){E.push(this),this.id=u+I++,this.NS="."+this.id,this.initialized=!1,this._animate=this._animate.bind(this),this._shouldCancelRAF=!0,this._lastTrackX=0,this.startItemPosWill=0,this.endItemPosWill=0,this.$willStartItem=null,this.$willEndItem=null,this.$leftItemsOver=null,this.$rightItemsOver=null,this.$insideItems=null,this.init(t)};C.CLASS=m,C.EVENT={tap:"tap",key:"key",scroll:"scroll",dragging:"dragging",dragend:"dragend",change:"change",possibleChange:"possiblechange"},C.DIR={LEFT:1,RIGHT:2},C.DEFAULTS=T,C.POSITION=_,C.CURRENT=v,C.FAKE_TRANSITION_TIMEOUT=700,C.CAPTURE_WHEEL_TIMEOUT=350,C.KEY_THROTTLE=75,C.WHEEL_THROTTLE=40,C.prototype.init=function(t,e){if(this.initialized){if(!e)return;this.destroy()}this._initOptions(t),this._lastDir=this.options.mode===_.END?C.DIR.RIGHT:C.DIR.LEFT,this._prepareSelf(),this._prepareTrack(),this._prepareItems(),this._initEvents(),this.initialized=!0,this.options.debug&&this.$self.addClass(m.debug)},C.prototype.destroy=function(){if(this.initialized){E.splice(E.indexOf(this),1),this._shouldCancelRAF=!0,this._forceCancelRAF=!0,cancelAnimationFrame(this._animate),this._destroyEvents(),this.$self.removeAttr("data-"+p.url).removeClass(m.self).removeClass(m.disabled).removeClass(this.options.mode===_.START?m.start:this.options.mode===_.END?m.end:m.center).removeClass(m.debug);var t={};t[i]="",t[n+"Duration"]="",this.$track.css(t).off(this.NS,"").removeClass(m.track).removeClass(m.dragging).removeClass(m.moving).removeClass(m.speed0).removeClass(m.speed1).removeClass(m.speed2).removeClass(m.speed3).removeData([p.willTranslate+this.NS,p.fakeTransitionTimeout+this.NS]),this.$items.each(function(t,e){var i=c(e);clearTimeout(i.data(p.fakeTransitionTimeout+this.NS)),i.removeData([p.fakeTransitionTimeout+this.NS,p.willLeft+this.NS,p.offset+this.NS,p.translate+this.NS])}.bind(this));var e={};e[i]="",this.options.reverseItems&&this._reverseItems(),this.$items.css(e).off(this.NS).removeClass(m.item).removeClass(m.current).removeClass(m.possibleCurrent).removeClass(m.toEnd).removeClass(m.toStart).removeClass(m.hide),this.$self=this.$track=this.$items=this.$currentItem=this.$leftItemsOver=this.$rightItemsOver=this.$insideItems=this._$possibleCurrent=this.$willStartItem=this.$willEndItem=null,this.initialized=!1}},C.prototype.refresh=function(e,i){this.destroy(),this.init(i?t.extend({},this.options,e):e)},C.prototype.softRefresh=function(t){this.refreshing=!0,this._generateSelfRect(),(this.options.refreshItems&&!1!==t||t)&&(this._prepareItems(!0),this.options.mode===_.CENTER?(this._move(1,!1,!0),this._move(-1,!1,!0)):this._move(this._lastDir!==C.DIR.LEFT?-1:1,!0,!0)),this.refreshing=!1},C.prototype.setCurrent=function(t){this._generateSelfRect(),"number"==typeof t?t=this.$items.eq(t):"string"==typeof t&&(t=this.$items.filter(t)),this._setCurrent(t)},C.prototype.on=function(t,e){this.$self.on(t,e)},C.prototype.off=function(t){this.$self.off(t)},C.prototype.disable=function(){this.$self.addClass(m.disabled),this.disabled=!0},C.prototype.enable=function(){this.$self.removeClass(m.disabled),this.disabled=!1},C.prototype.findNext=function(t){var e=(t=t||this.$currentItem).next();return e.length||(e=this.$items.first()),e},C.prototype.findPrev=function(t){var e=(t=t||this.$currentItem).prev();return e.length||(e=this.$items.last()),e},C.prototype.next=function(){this._lastDir=C.DIR.LEFT,this._setCurrent(this.findNext(),!1,!0)},C.prototype.prev=function(){this._lastDir=C.DIR.RIGHT,this._setCurrent(this.findPrev(),!1,!0)},C.prototype.dragging=function(){return this._hasPointer},C.prototype._initOptions=function(e){"string"==typeof e&&(e={selector:e}),e&&(e.jquery||e instanceof HTMLElement)&&(e={el:e}),(e=e||this.options||{}).mode===_.CENTER&&(e.currentOut=e.currentIn);var i=null;!1===e.fade&&((i=t.extend({},T)).startBreak=C.POSITION.END,i.endBreak=C.POSITION.START),e.mode===_.CENTER&&((i=i||t.extend({},T)).startBreak=C.POSITION.END,i.endBreak=C.POSITION.START,i.currentIn=C.CURRENT.CLOSEST,i.currentOut=C.CURRENT.CLOSEST,i.clearEdge=!1,i.balanced=!0),e.mode===_.END&&!1!==e.fade&&((i=i||t.extend({},T)).startBreak=_.END,i.endBreak=_.CENTER),this.options=t.extend({},i||T,this.options===e?{}:this.options,e)},C.prototype._prepareSelf=function(){this.$self=this.options.el&&this.options.el.jquery?this.options.el:t(this.options.el instanceof HTMLElement?this.options.el:this.options.selector),this.$self.attr("tabindex",0).attr("data-"+p.url,"https://github.com/michaljerabek/infinitum").addClass(this.options.mode===_.START?m.start:this.options.mode===_.END?m.end:m.center).addClass(m.self),this._generateSelfRect()},C.prototype._generateSelfRect=function(){this._selfRect={},this._origSelfRect=this.$self[0].getBoundingClientRect();var t=this.$self.css(["padding-left","padding-right","border-left-width","border-right-width"]);this._selfRect.left=this._origSelfRect.left+parseFloat(t["padding-left"])+parseFloat(t["border-left-width"]),this._selfRect.right=this._origSelfRect.right-parseFloat(t["padding-right"])-parseFloat(t["border-right-width"]),this._selfRect.center=this._origSelfRect.left+(this._origSelfRect.right-this._origSelfRect.left)/2},C.prototype._prepareTrack=function(){this.$track=this.options.trackSelector?t(this.options.trackSelector):this.$self.children().first(),this.$track.addClass(m.track),this._speed=[7,7,7,7,7],this._setTrackPosition(0,!1)},C.prototype._reverseItems=function(){var e=this.$items.first().parent();this.$items=t(this.$items.get().reverse()).each(function(t,i){e.append(i)}.bind(this))},C.prototype._prepareItems=function(e){e||(this.$currentItem=t()),this.$items=this.options.itemSelector?this.$track.find(this.options.itemSelector):this.$track.children(),this.$items.addClass(m.item),!this.initialized&&this.options.reverseItems&&this._reverseItems();var n=0,r=0;if(this.$items.each(function(t,e){var o=c(e),a={};a[i]=s?"translate3d(0px, 0px, 0px)":"translateX(0px)",o.css(a),o.data(p.translate+this.NS,0),o.data(p.offset+this.NS,n),o.data(p.willLeft+this.NS,n),n+=o.outerWidth(),r=n}.bind(this)),this._sortItems(),e)return this._moveToItem(this.$currentItem,!1,!1,!0),void(this._$possibleCurrent=this.$currentItem);this._initCurrentItem(r)},C.prototype._initCurrentItem=function(e){var i;if(null!==this.options.current&&void 0!==this.options.current&&("number"==typeof this.options.current?i=this.$items.eq(this.options.current):this.options.current instanceof HTMLElement?i=t(this.options.current):this.options.current.jquery&&(i=this.options.current)),!i||!i.length||-1===this.$items.get().indexOf(i[0]))if(this.options.mode===_.START)i=this.$items.first();else if(this.options.mode===_.END)i=this.$items.last();else{var s=0,n=e/2;this.$items.each(function(t,e){var i=c(e),r=i.data(p.willLeft+this.NS),o=r+i.outerWidth();if(r<=n&&o>=n)return s=t,!1}.bind(this)),i=this.$items.eq(s)}this._setCurrent(i,!1,!1,!1,!0),this._$possibleCurrent=this.$currentItem,this._fixItemsPositions()},C.prototype._initEvents=function(){1===E.length&&f.on("touchmove."+u,function(t){g.length&&t.preventDefault()}),this.$self.on("mousedown"+this.NS+" touchstart"+this.NS,this._onPointerStart.bind(this)),this.$self.on("click"+this.NS,m.selector("item"),function(t){this._byMouse||this._byTouch||this.disabled||this._onPointerEnd(t),this._byMouse=!1,t.preventDefault()}.bind(this));var t=null;this.$self.on("keydown"+this.NS,function(e){this.disabled||t||-1===[37,38,39,40].indexOf(e.which)||(t=!0,setTimeout(function(){t=!1},C.KEY_THROTTLE),this._onKey(e))}.bind(this));var e=null,i=!0;f.on("scroll"+this.NS,function(t){this.disabled||t.target!==document||(i=!1,clearTimeout(e),e=setTimeout(function(){i=!0},C.CAPTURE_WHEEL_TIMEOUT))}.bind(this));var s=null;this.$self.on("mousewheel"+this.NS+" DOMMouseScroll"+this.NS,function(t){i&&!this.disabled&&(s?t.preventDefault():(s=!0,setTimeout(function(){s=!1},C.WHEEL_THROTTLE),this._onWheel(t)))}.bind(this));var n=null,r=document.documentElement.clientHeight,o=document.documentElement.clientWidth;f.on("resize"+this.NS,function(){o===document.documentElement.clientWidth&&r===document.documentElement.clientHeight||(clearTimeout(n),n=setTimeout(this.softRefresh.bind(this),50),r=document.documentElement.clientHeight,o=document.documentElement.clientWidth)}.bind(this))},C.prototype._destroyEvents=function(){this.$self.off(this.NS),f.on(this.NS),E.length||f.off("touchstart."+u)},C.prototype._onPointerStart=function(t){this.disabled||(this._byMouse=!!t.type.match(/mouse/),this._byTouch=!!t.type.match(/touch/),this._hasPointer||this._byMouse&&0!==t.button?t.preventDefault():(this._generateSelfRect(),this.$self.focus(),this._hasPointer=!0,this._pointerIndex=0,this._draggingPrevented=!1,g.push(this),this._byTouch&&(this._hasPointer=t.originalEvent.changedTouches[0].identifier,this._findTouchPointerIndex(t)),this._fixVertical=null,this._clearTrackTransition(),this._shouldCancelRAF=!0,this._setPossibleCurrentItem(!1,!0,!0),this._lastClientY=l(t,"y",this._pointerIndex),this._lastClientX=l(t,"x",this._pointerIndex),this._trackMoved=!1,f.on("mousemove"+this.NS,this._onPointerMove.bind(this)),f.one("mouseup"+this.NS,this._onPointerEnd.bind(this)),this.$self.on("touchmove"+this.NS,this._onPointerMove.bind(this)),this.$self.one("touchend"+this.NS,this._onPointerEnd.bind(this)),this._byTouch||t.preventDefault()))},C.prototype._onPointerMove=function(e){if(this._hasPointer){e.type.match(/touch/)&&this._findTouchPointerIndex(e);var i=l(e,"y",this._pointerIndex),s=l(e,"x",this._pointerIndex),n=s-this._lastClientX;if(this._byTouch&&null===this._fixVertical&&(this._fixVertical=Math.abs(i-this._lastClientY)+1>Math.abs(n)),this._fixVertical)-1!==g.indexOf(this)&&g.splice(g.indexOf(this),1);else{if(n){this._trackMoved||this.$track.addClass(m.dragging);var r=t.extend({},t.Event(),{type:C.EVENT.dragging,target:this.$self[0],originalEvent:e.originalEvent,infinitum:this});if(this.$self.trigger(r,this),r.isDefaultPrevented())return void(this._draggingPrevented=!0);this._forceCancelRAF=!this._trackMoved,this._move(n,!1,!1)}this._lastDir=n?s>this._lastClientX?C.DIR.RIGHT:C.DIR.LEFT:this._lastDir,this._trackMoved=s!==this._lastClientX||this._trackMoved,this._lastClientX=s,this._lastClientY=i,e.preventDefault()}}else e.preventDefault()},C.prototype._isReverseDirection=function(){return this._lastDir===C.DIR.RIGHT&&(this.options.mode===_.START||this.options.mode===_.CENTER)||this._lastDir===C.DIR.LEFT&&this.options.mode===_.END},C.prototype._findTouchPointerIndex=function(e){t.each(e.originalEvent.touches,function(t,e){e.identifier===this._hasPointer&&(this._pointerIndex=t)}.bind(this))},C.prototype._onPointerEnd=function(e){if(!(this._byMouse&&0!==e.button||!this._hasPointer&&"click"!==e.type)){if(this._hasPointer=!1,this._forceCancelRAF=!1,-1!==g.indexOf(this)&&g.splice(g.indexOf(this),1),f.off("mousemove"+this.NS),this.$self.off("touchmove"+this.NS),!this._trackMoved&&null===this._fixVertical&&!this._draggingPrevented)return this._onTap(e);this._draggingPrevented=!1,this._setCurrent(this._findCurrentItem(),!1,!1,!0),this.$track.removeClass(m.dragging);var i=t.extend({},t.Event(),{type:C.EVENT.dragend,target:this.$self[0],originalEvent:e.originalEvent,infinitum:this});this.$self.trigger(i,this),this._trackMoved=!1,i.isDefaultPrevented()||e.preventDefault()}},C.prototype._onTap=function(e){var i=t(e.target).closest(m.selector("item"));if(i.length){if(this._triggerChangeTypeEvent(C.EVENT.tap,e,i).isDefaultPrevented())return;var s=d(this.$currentItem[0]).left,n=d(i[0]).left;this._lastDir=s>n?C.DIR.RIGHT:C.DIR.LEFT,this.options.wheelKeysTapSetCurrent?this._setCurrent(i,!1):this._moveToItem(i,!1)}return this._trackMoved=!1,!i.length},C.prototype._onWheel=function(t){if(!this.disabled){this._clearTrackTransition(),this._shouldCancelRAF=!0,cancelAnimationFrame(this._animate),this._lastDir=(t.originalEvent.detail||t.originalEvent.deltaY||t.originalEvent.deltaX)>0?C.DIR.LEFT:C.DIR.RIGHT;var e=this._lastDir===C.DIR.LEFT?this.findNext():this.findPrev();this._triggerChangeTypeEvent(C.EVENT.scroll,t,e).isDefaultPrevented()||(this._trackMoved=!0,this.$self.focus(),this._generateSelfRect(),this.options.wheelKeysTapSetCurrent?this._setCurrent(e,!1,!0):this._moveToItem(e,!0),t.preventDefault())}},C.prototype._onKey=function(t){if(!this.disabled){this._clearTrackTransition(),this._shouldCancelRAF=!0,cancelAnimationFrame(this._animate),this._lastDir=-1===[37,38].indexOf(t.which)?C.DIR.LEFT:C.DIR.RIGHT;var e=this._lastDir===C.DIR.LEFT?this.findNext():this.findPrev();this._triggerChangeTypeEvent(C.EVENT.key,t,e).isDefaultPrevented()||(this._trackMoved=!0,this._generateSelfRect(),this.options.wheelKeysTapSetCurrent?this._setCurrent(e,!1,!0):this._moveToItem(e,!0),t.preventDefault())}},C.prototype._triggerChangeTypeEvent=function(e,i,s,n){var r=t.extend({},t.Event(),{type:e,target:s[0],fromElement:this.$currentItem[0],toElement:s[0],originalEvent:i?i.originalEvent:null,infinitum:this},n||null);return this.$self.trigger(r,this),r},C.prototype._moveTrack=function(t,e,i){var s=h(this.$track).x+t;this._setTrackPosition(s,e,i)},C.prototype._setTrackPosition=function(t,e,r){if(this._clearTrackTransition(),this.$track.css(n,e?"":"none"),e){this._shouldCancelRAF=!1,this._forceCancelRAF=!1;var a,h=this._setTrackSpeed(t,r),l=function(t){(!t||t.originalEvent.target===this.$track[0]&&t.originalEvent.propertyName.match(/transform/i))&&(this._clearTrackTransition(),this.$track.css(n+"Duration",""),this._generateSelfRect(),this._shouldCancelRAF=!0)}.bind(this);this.$track.on(o+this.NS,l),a=setTimeout(l,h+50),this.$track.data(p.fakeTransitionTimeout+this.NS,a)}this.$track.css(i,s?"translate3d("+t+"px, 0px, 0px)":"translateX("+t+"px)"),this.$track.data(p.willTranslate+this.NS,t),e&&requestAnimationFrame(this._animate)},C.prototype._clearTrackTransition=function(){clearTimeout(this.$track.data(p.fakeTransitionTimeout+this.NS)),this.$track.off(o+this.NS).data(p.fakeTransitionTimeout+this.NS,null)},C.prototype._getAvgSpeed=function(){return this._speed.reduce(function(t,e){return t+e},0)/this._speed.length},C.prototype._setTrackSpeed=function(t,e){var i=h(this.$track).x,s=Math.abs(i-t),r=100;if(e){var o=this._getAvgSpeed();r/=Math.max(1,Math.log(o/3)),r=2*Math.max(Math.min(r,150),50)}var a=(r*Math.max(1,Math.log(s/5))).toFixed();return a=Math.max(Math.min(a,650),150),this.$track.css(n+"Duration",a+"ms"),a},C.prototype._setFadeSpeed=function(t,e){if(e){if(this.$track.hasClass(m.speed0))return;this.$track.removeClass(m.speed1).removeClass(m.speed2).removeClass(m.speed3).addClass(m.speed0)}else{t&&(this._speed=this._speed.slice(0,4),this._speed.unshift(Math.abs(t)));var i=this._getAvgSpeed();if(i<10){if(this.$track.hasClass(m.speed1))return;this.$track.removeClass(m.speed0).removeClass(m.speed2).removeClass(m.speed3).addClass(m.speed1)}else if(i<20){if(this.$track.hasClass(m.speed2))return;this.$track.removeClass(m.speed0).removeClass(m.speed1).removeClass(m.speed3).addClass(m.speed2)}else{if(this.$track.hasClass(m.speed3))return;this.$track.removeClass(m.speed0).removeClass(m.speed1).removeClass(m.speed2).addClass(m.speed3)}}},C.prototype._move=function(t,e,i,s){clearTimeout(this._fixItemsPositionsTimeout),this.$track.addClass(m.moving),this._setFadeSpeed(t,i&&(!s||!this.initialized)),e||i||this._moveTrack(t),this._sortItems(e);var n=e&&this._shouldCancelRAF&&(!t||this._forceCancelRAF),r=this.options.mode===_.END?this.$willEndItem:this.$willStartItem,o=n&&r.length&&!r.hasClass(m.current);this.options.mode===_.CENTER&&o&&(o=n&&this.$willEndItem.length&&!this.$willEndItem.hasClass(m.current)),this.options.mode===_.START?t<0||(o||i)&&this.options.clearEdge?this._moveLeftItemsOverToTheEnd(n,o,i):t>0&&this._moveRightItemsOverToTheStart(n):this.options.mode===_.END?t>0||(o||i)&&this.options.clearEdge?this._moveRightItemsOverToTheStart(n,o,i):t<0&&this._moveLeftItemsOverToTheEnd(n):t<0?this._moveLeftItemsOverToTheEnd(n):(t>0||i)&&this._moveRightItemsOverToTheStart(n),i||this._setPossibleCurrentItem(n,t),!n&&e||this.options.mode===_.CENTER&&e&&n&&!o&&this.options.balanced&&this.$items.length>2?requestAnimationFrame(this._animate):n&&(!i&&this.options.mode!==_.CENTER&&o&&this._fixItemsPositions(),this.$track.removeClass(m.moving))},C.prototype._fixItemsPositions=function(){clearTimeout(this._fixItemsPositionsTimeout);var t=!1;if(this.$items.each(function(e,i){if(c(i).data(p.fakeTransitionTimeout+this.NS))return this._fixItemsPositionsTimeout=setTimeout(this._fixItemsPositions.bind(this),0),!1;t=e===this.$items.length-1}.bind(this)),t){if(this._forceCancelRAF=!0,this.options.mode===_.CENTER)return this._move(1,!1,!0),void this._move(-1,!1,!0);this._move(this._lastDir===C.DIR.LEFT?-1:1,!0,!0,!0)}},C.prototype._sortItems=function(e){var i=this._getItemsData(e);this.startItemPosWill=i.startPosWill,this.endItemPosWill=i.endPosWill,this.endItemWidthWill=i.endWidthWill,this.$insideItems=t(i.inside),this.$willStartItem=this.$willStartItem&&this.$willStartItem[0]===i.willStart?this.$willStartItem:t(i.willStart),this.$willEndItem=this.$willEndItem&&this.$willEndItem[0]===i.willEnd?this.$willEndItem:t(i.willEnd),this._setItemsOverInCorrectOrder(i),this._setItemOverIfNotBreakOnEdge(i)},C.prototype._setItemsOverInCorrectOrder=function(e){e.leftOver.length>1?this.$leftItemsOver=t(e.leftOver.sort(function(t,e){return t.getBoundingClientRect().left-e.getBoundingClientRect().left})):this.$leftItemsOver=t(e.leftOver),e.rightOver.length>1?this.$rightItemsOver=t(e.rightOver.sort(function(t,e){return e.getBoundingClientRect().left-t.getBoundingClientRect().left})):this.$rightItemsOver=t(e.rightOver)},C.prototype._setItemOverIfNotBreakOnEdge=function(t){if(1!==this.$items.length||this.options.mode!==_.CENTER)if(this.options.mode===_.START||this.options.mode===_.CENTER&&this._isReverseDirection()){if(!this.options.breakOnEdge&&!this.$leftItemsOver.length&&!this.$rightItemsOver.length&&t.willStartRect.left>this._selfRect.left){if(this.options.balanced)return void(Math.abs(-this._selfRect.center+(t.willStartRect.left-t.willEndRect.width))<=Math.abs(-this._selfRect.center+t.willEndRect.right)&&(this.$rightItemsOver=this.$willEndItem));this.$rightItemsOver=this.$willEndItem}}else if(this.options.mode===_.END||this.options.mode===_.CENTER&&!this._isReverseDirection()){if(!this.options.breakOnEdge&&!this.$leftItemsOver.length&&!this.$rightItemsOver.length&&t.willEndRect.right<this._selfRect.right){if(this.options.balanced){var e=Math.abs(-this._selfRect.center+t.willStartRect.left);return void(Math.abs(-this._selfRect.center+(t.willEndRect.right+t.willEndRect.width))<=e&&(this.$leftItemsOver=this.$willStartItem))}this.$leftItemsOver=this.$willStartItem}}else;},C.prototype._getItemsData=function(t){var e=[],i=[],s=[],n=null,r=null,o=null,a=null,h=null,l=null,f=null;return this.$items.each(function(u,m){var v=c(m),T=d(m),g=v.data(p.willLeft+this.NS)-(v.data(p.translate+this.NS)+v.data(p.offset+this.NS));if((null===h||h>T.left+g)&&(h=T.left+g,n=m,o={left:T.left+g,right:T.right+g,width:T.width}),(null===l||l<T.right+g)&&(l=T.right+g,f=T.width,r=m,a={left:T.left+g,right:T.right+g,width:T.width}),t&&m===this._$possibleCurrent[0])s.push(m);else if(this.options.mode!==_.CENTER||!this.options.balanced||this.options.breakOnEdge){var E=this._getBreakEdge(T);E.left<this._selfRect.left?e.push(m):E.right>this._selfRect.right?i.push(m):s.push(m)}else T.left+g<=this._selfRect.center&&T.right+g>=this._selfRect.center?s.push(m):T.left+g<=this._selfRect.center?e.push(m):i.push(m)}.bind(this)),{leftOver:e,rightOver:i,inside:s,willStart:n,willEnd:r,willStartRect:o,willEndRect:a,startPosWill:h,endPosWill:l,endWidthWill:f}},C.prototype._getBreakEdge=function(t){var e=t.left,i=t.right-1;switch(this.options.startBreak){case C.POSITION.CENTER:e=t.left+t.width/2;break;case C.POSITION.END:e=t.right-1}switch(this.options.endBreak){case C.POSITION.START:i=t.left;break;case C.POSITION.CENTER:i=t.right-1-t.width/2}return{left:e,right:i}},C.prototype._moveLeftItemsOverToTheEnd=function(e,i,s){var n=this,r=0;this.$leftItemsOver.each(function(){var o=c(this),a=o.outerWidth();if(!n.options.balanced||n.options!==_.CENTER&&e&&s&&n.options.clearEdge){if(n.options.mode===_.START||n.options.mode===_.CENTER){if(!n.options.breakAll&&!n.options.clearEdge&&n.endItemPosWill+r>=n._selfRect.right)return}else if(n.options.mode===_.END&&!n.options.breakAll&&n.endItemPosWill+r+.5>=n._selfRect.right)return}else{var h=Math.abs(-n._selfRect.center+(n.startItemPosWill+r));if(Math.abs(-n._selfRect.center+(n.endItemPosWill+r+a))>=h)return!1}i&&(o.hasClass(m.current)||!n.options.clearEdge&&!s)||(!o.hasClass(m.hide)||o.hasClass(m.toStart)||i||s)&&(r+=a,n._breakItem(t(this),"end"))}),e&&this._clearHideStates("start")},C.prototype._moveRightItemsOverToTheStart=function(e,i,s){var n=this,r=0;this.$rightItemsOver.each(function(){var o=c(this),a=o.outerWidth();if(!n.options.balanced||n.options!==_.CENTER&&e&&s&&n.options.clearEdge){if(n.options.mode===_.START||n.options.mode===_.CENTER){if(!n.options.breakAll&&n.startItemPosWill-r-.5<=n._selfRect.left)return}else if(n.options.mode===_.END&&!n.options.breakAll&&!n.options.clearEdge&&n.startItemPosWill-r<=n._selfRect.left)return}else if(Math.abs(-n._selfRect.center+(n.startItemPosWill-r-a))>=Math.abs(-n._selfRect.center+(n.endItemPosWill-r)))return!1;i&&(o.hasClass(m.current)||!n.options.clearEdge&&!s)||(!o.hasClass(m.hide)||o.hasClass(m.toEnd)||i||s)&&(r+=a,n._breakItem(t(this),"start"))}),e&&this._clearHideStates("end")},C.prototype._breakItem=function(t,e){t.off(o+this.NS);var r=t.data(p.fakeTransitionTimeout+this.NS);r&&clearTimeout(r);var a="start"===e?this.findNext(t):this.findPrev(t),h="start"===e?t.outerWidth():-a.outerWidth(),l=a.data(p.willLeft+this.NS)-h;if(!this.options.fade){var d={},c=l-t.data(p.offset+this.NS);return d[i]=s?"translate3d("+c+"px, 0px, 0px)":"translateX("+c+"px)",d[n]="",void t.css(d).data(p.translate+this.NS,c).data(p.willLeft+this.NS,l)}var f=t.css("opacity");t.addClass("start"===e?m.toStart:m.toEnd).removeClass("start"===e?m.toEnd:m.toStart).removeClass(m.hide),t.data(p.willLeft+this.NS,l);var u,v="end"===e&&this.options.fade===_.END||"start"===e&&this.options.fade===_.START,T=function(r){if(!r||r.originalEvent.target===t[0]||"opacity"===r.originalEvent.propertyName){clearTimeout(u);var a={},h=t.data(p.willLeft+this.NS)-t.data(p.offset+this.NS);a[i]=s?"translate3d("+h+"px, 0px, 0px)":"translateX("+h+"px)",a[n]=v||!0===this.options.fade?"":"none",t.data(p.translate+this.NS,h).css(a),t.data(p.fakeTransitionTimeout+this.NS,null),t.removeClass(m.hide).removeClass("start"===e?m.toStart:m.toEnd),t.off(o+this.NS)}}.bind(this);v?(t.css(n,"none").addClass(m.hide),u=setTimeout(T,0),t.data(p.fakeTransitionTimeout+this.NS,u)):parseFloat(f)?(u=setTimeout(T,C.FAKE_TRANSITION_TIMEOUT),t.data(p.fakeTransitionTimeout+this.NS,u),t.on(o+this.NS,T),t.css(n,""),t.addClass(m.hide)):T()},C.prototype._clearHideStates=function(t){if(this.options.fade){var e=this;("end"===t?this.$rightItemsOver:this.$leftItemsOver).each(function(){var i=c(this);("end"===t?i.hasClass(m.toStart):i.hasClass(m.toEnd))||(i.off(o+e.NS),clearTimeout(i.data(p.fakeTransitionTimeout+e.NS)),i.data(p.fakeTransitionTimeout+e.NS,null),i.removeClass(m.hide).removeClass("end"===t?m.toEnd:m.toStart),i.data(p.willLeft+e.NS,i.data(p.translate+e.NS)+i.data(p.offset+e.NS)))})}},C.prototype._animate=function(){this._move(h(this.$track).x-this._lastTrackX,!0),this._lastTrackX=h(this.$track).x},C.prototype._setCurrent=function(t,e,i,s,n){if(t&&t[0]){if(t[0]!==this.$currentItem[0]){if(this._triggerChangeTypeEvent(C.EVENT.change,null,t).isDefaultPrevented())return void(e||this._moveToItem(this.$currentItem,i,s,n));this.$currentItem.removeClass(m.current),this.$currentItem=t,t.addClass(m.current)}e||this._moveToItem(t,i,s,n)}},C.prototype._moveToItem=function(t,e,i,s){switch(this.options.mode){case _.START:return this._moveToItemModeStart(t,e,i,s);case _.END:return this._moveToItemModeEnd(t,e,i,s);case _.CENTER:return this._moveToItemModeCenter(t,e,i,s)}},C.prototype._moveToItemModeCenter=function(t,e,i,s){var n,r=t.data(p.willLeft+this.NS),o=t.data(p.translate+this.NS)+t.data(p.offset+this.NS),a=d(t[0]);if(s&&(this._shouldCancelRAF=!0,this._forceCancelRAF=!0),e){if(1===this.$items.length)return;if(n=this.$track.data(p.willTranslate+this.NS),this._isReverseDirection()){var h=this.findNext(t).outerWidth();return void this._setTrackPosition(n+a.width/2+h/2,!s,i)}var l=this.findPrev(t).outerWidth();this._setTrackPosition(n-a.width/2-l/2,!s,i)}else{var c=a.left+(r-o)-this._selfRect.left-(this._selfRect.right-this._selfRect.left)/2+a.width/2;c&&this._moveTrack(-c,!s,i)}},C.prototype._moveToItemModeEnd=function(t,e,i,s){var n,r=t.data(p.willLeft+this.NS),o=t.data(p.translate+this.NS)+t.data(p.offset+this.NS),a=d(t[0]);if(s&&(this._shouldCancelRAF=!0,this._forceCancelRAF=!0),e){if(1===this.$items.length)return;if(n=this.$track.data(p.willTranslate+this.NS),this._isReverseDirection())return void this._setTrackPosition(n-a.width,!s,i);var h=this.findNext(t).outerWidth();this._setTrackPosition(n+h,!s,i)}else{var l=a.right+(r-o)-this._selfRect.right;l?this._moveTrack(-l,!s,i):this.$willEndItem.length&&!this.$willEndItem.hasClass(m.current)&&this._fixItemsPositions()}},C.prototype._moveToItemModeStart=function(t,e,i,s){var n,r=t.data(p.willLeft+this.NS),o=t.data(p.translate+this.NS)+t.data(p.offset+this.NS),a=d(t[0]);if(s&&(this._shouldCancelRAF=!0,this._forceCancelRAF=!0),e){if(1===this.$items.length)return;if(n=this.$track.data(p.willTranslate+this.NS),this._isReverseDirection())return void this._setTrackPosition(n+a.width,!s,i);var h=this.findPrev(t).outerWidth();this._setTrackPosition(n-h,!s,i)}else{var l=a.left+(r-o)-this._selfRect.left;l?this._moveTrack(-l,!s,i):this.$willStartItem.length&&!this.$willStartItem.hasClass(m.current)&&this._fixItemsPositions()}},C.prototype._setPossibleCurrentItem=function(t,e,i){if(e){var s=this._findCurrentItem(),n=s[0]!==this._$possibleCurrent[0];(n||i)&&(s.addClass(m.possibleCurrent),n&&(this._$possibleCurrent.removeClass(m.possibleCurrent),this._triggerChangeTypeEvent(C.EVENT.possibleChange,null,s),this._$possibleCurrent=s))}if(t)return this._$possibleCurrent.removeClass(m.possibleCurrent),void(e&&this._setCurrent(this._$possibleCurrent))},C.prototype._findCurrentItem=function(){return this._findClosestItem(this._isReverseDirection()?"out":"in")},C.prototype._findClosestItem=function(e){var i,s=null,n="in"===e?"currentIn":"currentOut";return this.$items.each(function(t,r){var o,a,h=c(r),l=h.data(p.willLeft+this.NS),f=h.data(p.translate+this.NS)+h.data(p.offset+this.NS),u=d(r),m=u.left+(l-f),T=u.right+(l-f);if(this.options.mode!==_.CENTER||this.options[n]===v.CLOSEST)this.options.mode===_.CENTER&&this.options[n]===v.CLOSEST?(o=m-this._selfRect.center+1,a=T-this._selfRect.center-1):(o=m-this._selfRect[this.options.mode===_.END?"right":"left"],a=T-this._selfRect[this.options.mode===_.END?"right":"left"]),this._isCloser(e,s,o,a)&&(s=this.options.mode===_.CENTER&&this.options[n]===v.CLOSEST?"in"===e?o:a:this.options.mode===_.END?a:o,i=r);else if(this._isCenter(m,T))return i=r,!1}.bind(this)),t(i)},C.prototype._isCenter=function(t,e){return t<=this._selfRect.center&&e>=this._selfRect.center},C.prototype._isCloser=function(t,e,i,s){var n="in"===t?"currentIn":"currentOut";if(this.options.mode===_.START)switch(this.options[n]){case v.CLOSEST:return null===e||Math.abs(i)<Math.abs(e);case v.FULL:return i>=0&&(null===e||Math.abs(i)<Math.abs(e));case v.STILL_INSIDE:return s>=.5&&(null===e||i<e)}else{if(this.options.mode!==_.END){if(this.options[n]===v.CLOSEST)switch(t){case"in":return null===e||Math.abs(i)<Math.abs(e);case"out":return null===e||Math.abs(s)<Math.abs(e)}return null===e||Math.abs(i)<Math.abs(e)}switch(this.options[n]){case v.CLOSEST:return null===e||Math.abs(s)<Math.abs(e);case v.FULL:return s<=0&&(null===e||Math.abs(s)<Math.abs(e));case v.STILL_INSIDE:return i<=-.5&&(null===e||s>e)}}}}(jQuery);
